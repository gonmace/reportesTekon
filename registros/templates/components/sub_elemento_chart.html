{% load crispy_forms_tags %}

<div class="sub-elemento sub-elemento-chart">
    <div class="card">
        <div class="card-header">
            <h5 class="card-title mb-0">
                <i class="fas fa-chart-bar me-2"></i>
                Gráfico de Datos
            </h5>
        </div>
        <div class="card-body">
            {% if data and data.labels %}
                <div class="chart-container" style="position: relative; height: 400px;">
                    <canvas id="chart-{{ elemento_padre.tipo }}"></canvas>
                </div>
                
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const ctx = document.getElementById('chart-{{ elemento_padre.tipo }}').getContext('2d');
                        new Chart(ctx, {
                            type: '{{ data.type }}',
                            data: {
                                labels: {{ data.labels|safe }},
                                datasets: [{
                                    label: '{{ elemento_padre.tipo|title }}',
                                    data: {{ data.data|safe }},
                                    backgroundColor: [
                                        'rgba(59, 130, 246, 0.8)',
                                        'rgba(16, 185, 129, 0.8)',
                                        'rgba(245, 158, 11, 0.8)',
                                        'rgba(239, 68, 68, 0.8)',
                                        'rgba(139, 92, 246, 0.8)'
                                    ],
                                    borderColor: [
                                        'rgba(59, 130, 246, 1)',
                                        'rgba(16, 185, 129, 1)',
                                        'rgba(245, 158, 11, 1)',
                                        'rgba(239, 68, 68, 1)',
                                        'rgba(139, 92, 246, 1)'
                                    ],
                                    borderWidth: 2
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        position: 'top',
                                    },
                                    title: {
                                        display: true,
                                        text: 'Datos de {{ elemento_padre.tipo|title }}'
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true
                                    }
                                }
                            }
                        });
                    });
                </script>
            {% else %}
                <div class="text-center text-muted py-4">
                    <i class="fas fa-chart-bar fa-3x mb-3"></i>
                    <p>No hay datos para mostrar en el gráfico</p>
                    <small>Complete el formulario para ver estadísticas</small>
                </div>
            {% endif %}
        </div>
    </div>
</div> 